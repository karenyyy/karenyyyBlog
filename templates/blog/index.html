{% load staticfiles %}
{% load blog_tags %}
<!DOCTYPE html>
<html>
<head>
    <title>Karenyyy</title>

    <!-- meta -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- css -->
    <link rel="stylesheet" href="https://raw.githubusercontent.com/karenyyy/karenyyyBlog/master/blog/static/blog/css/ionicons.min.css">
    <link href="https://fonts.googleapis.com/css?family=Permanent+Marker" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Raleway:100,600" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'blog/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'blog/css/pace.css' %}">
    <link rel="stylesheet" href="{% static 'blog/css/custom.css' %}">
    <link rel="stylesheet" href="{% static 'blog/css/highlights/github.css' %}">
    <style>
        span.highlighted {
            color: red;
        }
    </style>
    <!-- js -->
    <script src="{% static 'blog/js/jquery-2.1.3.min.js' %}"></script>
    <script src="{% static 'blog/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'blog/js/pace.min.js' %}"></script>
    <script src="{% static 'blog/js/modernizr.custom.js' %}"></script>

</head>

<body>

<div class="logo">
    <h1><a href="{% url 'blog:index' %}"><b style="font-family: 'Permanent Marker', cursive"><center>Karenyyy's Personal Site</center></b></a></h1>
</div>
<script src="{% static 'three.js/build/three.js' %}"></script>
<script src="{% static 'three.js/examples/js/RollerCoaster.js' %}"></script>

<script src="{% static 'three.js/examples/js/vr/WebVR.js'%}"></script>

<script>

    var renderer = new THREE.WebGLRenderer( { antialias: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.vr.enabled = true;
    document.body.appendChild( renderer.domElement );


    var scene = new THREE.Scene();
    scene.background = new THREE.Color( 0xf0f0ff );

    var light = new THREE.HemisphereLight( 0xfff0f0, 0x606066 );
    light.position.set( 1, 1, 1 );
    scene.add( light );

    var train = new THREE.Object3D();
    scene.add( train );

    var camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 0.1, 500 );
    train.add( camera );

    // environment

    var geometry = new THREE.PlaneBufferGeometry( 500, 500, 15, 15 );
    geometry.applyMatrix( new THREE.Matrix4().makeRotationX( - Math.PI / 2 ) );

    var positions = geometry.attributes.position.array;
    var vertex = new THREE.Vector3();

    for ( var i = 0; i < positions.length; i += 3 ) {

        vertex.fromArray( positions, i );

        vertex.x += Math.random() * 10 - 5;
        vertex.z += Math.random() * 10 - 5;

        var distance = ( vertex.distanceTo( scene.position ) / 5 ) - 25;
        vertex.y = Math.random() * Math.max( 0, distance );

        vertex.toArray( positions, i );

    }

    geometry.computeVertexNormals();

    var material = new THREE.MeshLambertMaterial( {
        color: 0x407000
    } );

    var mesh = new THREE.Mesh( geometry, material );
    scene.add( mesh );

    var geometry = new TreesGeometry( mesh );
    var material = new THREE.MeshBasicMaterial( {
        side: THREE.DoubleSide, vertexColors: THREE.VertexColors
    } );
    var mesh = new THREE.Mesh( geometry, material );
    scene.add( mesh );

    var geometry = new SkyGeometry();
    var material = new THREE.MeshBasicMaterial( { color: 0xffffff } );
    var mesh = new THREE.Mesh( geometry, material );
    scene.add( mesh );

    //

    var PI2 = Math.PI * 2;

    var curve = ( function () {

        var vector = new THREE.Vector3();
        var vector2 = new THREE.Vector3();

        return {

            getPointAt: function ( t ) {

                t = t * PI2;

                var x = Math.sin( t * 3 ) * Math.cos( t * 4 ) * 50;
                var y = Math.sin( t * 10 ) * 2 + Math.cos( t * 17 ) * 2 + 5;
                var z = Math.sin( t ) * Math.sin( t * 4 ) * 50;

                return vector.set( x, y, z ).multiplyScalar( 2 );

            },

            getTangentAt: function ( t ) {

                var delta = 0.0001;
                var t1 = Math.max( 0, t - delta );
                var t2 = Math.min( 1, t + delta );

                return vector2.copy( this.getPointAt ( t2 ) )
                    .sub( this.getPointAt( t1 ) ).normalize();

            }

        };

    } )();

    var geometry = new RollerCoasterGeometry( curve, 1500 );
    var material = new THREE.MeshPhongMaterial( {
        vertexColors: THREE.VertexColors
    } );
    var mesh = new THREE.Mesh( geometry, material );
    scene.add( mesh );

    var geometry = new RollerCoasterLiftersGeometry( curve, 100 );
    var material = new THREE.MeshPhongMaterial();
    var mesh = new THREE.Mesh( geometry, material );
    mesh.position.y = 0.1;
    scene.add( mesh );

    var geometry = new RollerCoasterShadowGeometry( curve, 500 );
    var material = new THREE.MeshBasicMaterial( {
        color: 0x305000, depthWrite: false, transparent: true
    } );
    var mesh = new THREE.Mesh( geometry, material );
    mesh.position.y = 0.1;
    scene.add( mesh );

    var funfairs = [];

    //

    var geometry = new THREE.CylinderBufferGeometry( 10, 10, 5, 15 );
    var material = new THREE.MeshLambertMaterial( {
        color: 0xff8080,
        //flatShading: true // Lambert does not support flat shading
    } );
    var mesh = new THREE.Mesh( geometry, material );
    mesh.position.set( - 80, 10, - 70 );
    mesh.rotation.x = Math.PI / 2;
    scene.add( mesh );

    funfairs.push( mesh );

    var geometry = new THREE.CylinderBufferGeometry( 5, 6, 4, 10 );
    var material = new THREE.MeshLambertMaterial( {
        color: 0x8080ff,
        //flatShading: true // Lambert does not support flat shading
    } );
    var mesh = new THREE.Mesh( geometry, material );
    mesh.position.set( 50, 2, 30 );
    scene.add( mesh );

    funfairs.push( mesh );

    //

    window.addEventListener( 'resize', onWindowResize, false );

    function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

    }

    //

    var position = new THREE.Vector3();
    var tangent = new THREE.Vector3();

    var lookAt = new THREE.Vector3();

    var velocity = 0;
    var progress = 0;

    var prevTime = performance.now();

    function render() {

        var time = performance.now();
        var delta = time - prevTime;

        for ( var i = 0; i < funfairs.length; i ++ ) {

            funfairs[ i ].rotation.y = time * 0.0004;

        }

        //

        progress += velocity;
        progress = progress % 1;

        position.copy( curve.getPointAt( progress ) );
        position.y += 0.3;

        train.position.copy( position );

        tangent.copy( curve.getTangentAt( progress ) );

        velocity -= tangent.y * 0.0000001 * delta;
        velocity = Math.max( 0.00004, Math.min( 0.0002, velocity ) );

        train.lookAt( lookAt.copy( position ).sub( tangent ) );

        //

        renderer.render( scene, camera );

        prevTime = time;

    }

    renderer.animate( render );

</script>

<div class="container">
    <header id="site-header">
        <div class="row">
            <div class="col-md-4 col-sm-5 col-xs-8">

            </div><!-- col-md-4 -->
            <div class="col-md-8 col-sm-7 col-xs-4">
                <nav class="main-nav" role="navigation">
                    <div class="navbar-header">
                        <button type="button" id="trigger-overlay" class="navbar-toggle">
                            <span class="ion-navicon"></span>
                        </button>
                    </div>

                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav navbar-right">
                            <li class="cl-effect-11"><a href="{% url 'blog:index' %}" data-hover="Home">Home</a></li>
                            <li class="cl-effect-11"><a href="https://karenyyyblog.herokuapp.com" data-hover="Fun projects">Fun projects</a></li>
                            <li class="cl-effect-11"><a href="https://github.com/karenyyy" data-hover="Github">Github</a></li>
                        </ul>
                    </div><!-- /.navbar-collapse -->
                </nav>
                <div id="header-search-box">
                    <a id="search-menu" href="#"><span id="search-icon" class="ion-ios-search-strong"></span></a>
                    <div id="search-form" class="search-form">
                        <form role="search" method="get" id="searchform" action="{% url 'haystack_search' %}">
                            <input type="search" name="q" placeholder="search" required>
                            <button type="submit"><span class="ion-ios-search-strong"></span></button>
                        </form>
                    </div>
                </div>
            </div><!-- col-md-8 -->
        </div>
    </header>
</div>


<div class="content-body">
    <div class="container">
        <div class="row">
            <main class="col-md-8">
                {% block main %}
                    {% if error_msg %}
                        <p>{{ error_msg }}</p>
                    {% endif %}

                    {% for post in post_list %}
                        <article class="post post-{{ post.pk }}">
                            <header class="entry-header">
                                <h1 class="entry-title">
                                    <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
                                </h1>
                                <div class="entry-meta">
                    <span class="post-category">
                        <a href="{% url 'blog:category' post.category.pk %}">{{ post.category.name }}</a></span>
                                    <span class="post-date"><a href="#"><time class="entry-date"
                                                                              datetime="{{ post.created_time }}">{{ post.created_time }}</time></a></span>
                                    <span class="post-author"><a href="#">{{ post.author }}</a></span>

                                </div>
                            </header>
                            <div class="entry-content clearfix">
                                <p>{{ post.excerpt }}...</p>
                                <div class="read-more cl-effect-14">
                                    <a href="{{ post.get_absolute_url }}" class="more-link">Continue reading <span class="meta-nav">→</span></a>
                                </div>
                            </div>
                        </article>
                    {% empty %}
                        <div class="no-post">Nothing to see in this moment ~(+_+)~</div>
                    {% endfor %}


                    {% if is_paginated %}
                        <div class="pagination">
                            <ul>
                                {% if first %}
                                    <li><a href="?page=1">1</a></li>
                                {% endif %}
                                {% if left %}
                                    {% if left_has_more %}
                                        <li><span>...</span></li>
                                    {% endif %}
                                    {% for i in left %}
                                        <li><a href="?page={{ i }}">{{ i }}</a></li>
                                    {% endfor %}
                                {% endif %}
                                <li class="current"><a href="?page={{ page_obj.number }}">{{ page_obj.number }}</a></li>
                                {% if right %}
                                    {% for i in right %}
                                        <li><a href="?page={{ i }}">{{ i }}</a></li>
                                    {% endfor %}
                                    {% if right_has_more %}
                                        <li><span>...</span></li>
                                    {% endif %}
                                {% endif %}
                                {% if last %}
                                    <li><a href="?page={{ paginator.num_pages }}">{{ paginator.num_pages }}</a></li>
                                {% endif %}
                            </ul>
                        </div>
                    {% endif %}
                {% endblock main %}
            </main>
            <aside class="col-md-4">
                {% block toc %}
                {% endblock toc %}
                <div class="widget widget-recent-posts">
                    <h3 class="widget-title">Latest</h3>
                    {% get_recent_posts as recent_post_list %}
                    <ul>
                        {% for post in recent_post_list %}
                            <li>
                                <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
                            </li>
                        {% empty %}
                            Nothing to see in this moment ~(+_+)~
                        {% endfor %}
                    </ul>
                </div>
                <div class="widget widget-archives">
                    <h3 class="widget-title">Archive</h3>
                    {% archives as date_list %}
                    <ul>
                        {% for date in date_list %}
                            <li>
                                <a href="{% url 'blog:archives' date.year date.month %}">{{ date.year }}
                                    / {{ date.month }}</a>
                            </li>
                        {% empty %}
                            Nothing to see in this moment ~(+_+)~
                        {% endfor %}
                    </ul>
                </div>

                <div class="widget widget-category">
                    <h3 class="widget-title">Categories</h3>
                    {% get_categories as category_list %}
                    <ul>
                        {% for category in category_list %}
                            <li>
                                <a href="{% url 'blog:category' category.pk %}">{{ category.name }} <span
                                        class="post-count">({{ category.num_posts }})</span></a>
                            </li>
                        {% empty %}
                            Nothing to see in this moment ~(+_+)~
                        {% endfor %}
                    </ul>
                </div>

                <div class="widget widget-tag-cloud">
                    <h3 class="widget-title">Tag cloud</h3>
                    {% get_tags as tag_list %}
                    <ul>
                        {% for tag in tag_list %}
                            <li>
                                <a href="{% url 'blog:tag' tag.pk %}">{{ tag.name }}</a>
                            </li>
                        {% empty %}
                            Nothing to see in this moment ~(+_+)~
                        {% endfor %}
                    </ul>
                </div>

            </aside>
        </div>
    </div>
</div>



<script src="{% static 'blog/js/script.js' %}"></script>




</body>
</html>